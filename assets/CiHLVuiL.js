import{l as y,o as c,c as i,a as e,F as S,r as P,t as v,f as w,m as U,p as T,v as V,b as I,k as B,n as D,d as z,h as H,j as O}from"./B0xCWv1f.js";const j={class:"relative"},N={key:0,class:"absolute bottom-8 left-0 bg-white border border-gray-200 rounded-lg shadow-lg p-2"},q=["onClick"],E={__name:"EmojiPicker",emits:["select"],setup(l,{emit:x}){const r=["😊","😂","🤔","👍","❤️","😎","🎉","🌟","🤩","😍"],a=y(!1),o=()=>{a.value=!a.value},n=p=>{h("select",p),a.value=!1},h=x;return(p,m)=>(c(),i("div",j,[e("button",{onClick:o,class:"text-gray-500 hover:text-blue-500 focus:outline-none"}," 😊 "),a.value?(c(),i("div",N,[(c(),i(S,null,P(r,g=>e("button",{key:g,onClick:f=>n(g),class:"p-1 hover:bg-gray-100 rounded"},v(g),9,q)),64))])):w("",!0)]))}},F={class:"p-4 rounded-lg"},Y={class:"flex items-start space-x-3"},G=["src"],J={class:"flex-grow"},K=["placeholder","rows"],Q={key:0,class:"flex justify-between items-center mt-2"},W={class:"flex items-center space-x-2"},X={class:"text-sm text-gray-500"},Z={key:1,class:"mt-2"},ee=["src"],R={__name:"CommentEditor",props:{userAvatar:{type:String,required:!0},placeholder:{type:String,default:"Post a friendly comment (Markdown syntax supported)"},submitButtonText:{type:String,default:"Post"}},emits:["submit"],setup(l,{emit:x}){const r=x,a=y(""),o=y(null),n=y(!1),h=()=>{n.value=!0},p=()=>{g()},m=()=>{a.value.trim()===""&&!o.value&&(n.value=!1)},g=()=>{a.value.length>1e3&&(a.value=a.value.slice(0,1e3))},f=d=>{a.value+=d},C=async d=>{const t=d.target.files[0];t&&(o.value=URL.createObjectURL(t),a.value+=`

![Uploaded Image](${o.value})`)},M=()=>{(a.value.trim()||o.value)&&(r("submit",{content:a.value,imageUrl:o.value}),a.value="",o.value=null,n.value=!1)};return U([a,o],([d,t])=>{d.trim()===""&&!t?n.value=!1:n.value=!0}),(d,t)=>(c(),i("div",F,[e("div",Y,[e("img",{src:l.userAvatar,alt:"Your Avatar",class:"w-10 h-10 rounded-full"},null,8,G),e("div",J,[T(e("textarea",{"onUpdate:modelValue":t[0]||(t[0]=s=>a.value=s),placeholder:l.placeholder,rows:a.value.split(/\r\n|\r|\n/).length>=2?a.value.split(/\r\n|\r|\n/).length:2,class:"w-full p-2 border border-gray-300 rounded-md h-auto hover:outline-none hover:ring-2 hover:ring-blue-500 bg-slate-100 hover:bg-white resize-none overflow-hidden placeholder:leading-[3rem] leading-[1.5rem]",onInput:p,onBlur:m,onClick:h},null,40,K),[[V,a.value]]),n.value?(c(),i("div",Q,[e("div",W,[e("div",X,v(a.value.length)+"/1000",1),I(E,{onSelect:f}),e("input",{type:"file",accept:"image/*",onChange:C,class:"hidden",ref:"imageInput"},null,544),e("button",{onClick:t[1]||(t[1]=s=>d.$refs.imageInput.click()),class:"text-blue-500 hover:text-blue-600 focus:outline-none"}," 上传图片 ")]),e("button",{onClick:M,class:"px-8 py-2 bg-blue-500 text-white rounded-full hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-opacity-50"},v(l.submitButtonText),1)])):w("",!0),o.value?(c(),i("div",Z,[e("img",{src:o.value,alt:"Uploaded image",class:"max-w-full h-auto rounded-md"},null,8,ee)])):w("",!0)])])]))}},te={class:"mb-6 pb-4 border-b border-gray-200"},se={class:"flex items-start"},ae=["src"],ne={class:"flex-grow"},oe={class:"flex items-center"},le={class:"font-bold text-blue-500"},re={class:"ml-2 text-xs text-gray-500"},ce=["innerHTML"],ie={class:"mt-2 flex items-center space-x-4"},ue={key:0},de={key:1,class:"mt-3 bg-gray-50 p-3 rounded-lg"},me={class:"flex items-start"},ve=["src"],ge={class:"flex items-center"},he={class:"font-bold text-blue-500 text-sm"},pe={class:"ml-2 text-xs text-gray-500"},ye=["innerHTML"],fe={key:2,class:"mt-2 flex justify-between items-center"},be={class:"text-sm text-gray-500"},xe={class:"space-x-2"},_e=["disabled"],we=["disabled"],L=5,$e={__name:"CommentItem",props:{comment:{type:Object,required:!0},currentUserAvatar:{type:String,required:!0}},emits:["like","reply","load-replies"],setup(l,{emit:x}){const r=l,a=x,o=y(!1),n=y(1),h=B(()=>Math.ceil(r.comment.replyCount/L)),p=d=>d,m=d=>{const t=new Date(d),u=new Date-t,$=Math.floor(u/1e3),b=Math.floor($/60),_=Math.floor(b/60),A=Math.floor(_/24);return A>0?`${A}天前`:_>0?`${_}小时前`:b>0?`${b}分钟前`:"刚刚"},g=()=>{a("like",r.comment.id)},f=()=>{o.value=!o.value},C=d=>{a("reply",{commentId:r.comment.id,...d}),o.value=!1},M=d=>{const t=n.value+d;t>=1&&t<=h.value&&(n.value=t,a("load-replies",{commentId:r.comment.id,page:n.value,perPage:L}))};return(d,t)=>(c(),i("div",te,[e("div",se,[e("img",{src:l.comment.avatar,alt:"User Avatar",class:"w-10 h-10 rounded-full mr-3"},null,8,ae),e("div",ne,[e("div",oe,[e("span",le,v(l.comment.username),1),e("span",re,v(m(l.comment.createdAt)),1)]),e("div",{class:"mt-1 text-gray-700",innerHTML:p(l.comment.content)},null,8,ce),e("div",ie,[e("button",{onClick:g,class:"flex items-center text-gray-500 hover:text-blue-500"},[(c(),i("svg",{xmlns:"http://www.w3.org/2000/svg",class:D(["h-4 w-4 mr-1",{"text-blue-500":l.comment.liked}]),viewBox:"0 0 20 20",fill:"currentColor"},t[2]||(t[2]=[e("path",{d:"M2 10.5a1.5 1.5 0 113 0v6a1.5 1.5 0 01-3 0v-6zM6 10.333v5.43a2 2 0 001.106 1.79l.05.025A4 4 0 008.943 18h5.416a2 2 0 001.962-1.608l1.2-6A2 2 0 0015.56 8H12V4a2 2 0 00-2-2 1 1 0 00-1 1v.667a4 4 0 01-.8 2.4L6.8 7.933a4 4 0 00-.8 2.4z"},null,-1)]),2)),e("span",null,v(l.comment.likes),1)]),e("button",{onClick:f,class:"text-gray-500 hover:text-blue-500"},[t[3]||(t[3]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1 inline",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H4a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2zM7 8H5v2h2V8zm2 0h2v2H9V8zm6 0h-2v2h2V8z","clip-rule":"evenodd"})],-1)),z(" Reply ("+v(l.comment.replyCount)+") ",1)])]),o.value?(c(),i("div",ue,[I(R,{"user-avatar":l.currentUserAvatar,placeholder:"Reply to comment (Markdown syntax supported)","submit-button-text":"Post Reply",onSubmit:C},null,8,["user-avatar"])])):w("",!0),l.comment.replies&&l.comment.replies.length>0?(c(),i("div",de,[(c(!0),i(S,null,P(l.comment.replies,s=>(c(),i("div",{key:s.id,class:"mb-2 last:mb-0"},[e("div",me,[e("img",{src:s.avatar,alt:"User Avatar",class:"w-6 h-6 rounded-full mr-2"},null,8,ve),e("div",null,[e("div",ge,[e("span",he,v(s.username),1),e("span",pe,v(m(s.createdAt)),1)]),e("div",{class:"mt-1 text-sm text-gray-700",innerHTML:p(s.content)},null,8,ye)])])]))),128))])):w("",!0),l.comment.replyCount>0?(c(),i("div",fe,[e("div",be," Page "+v(n.value)+" of "+v(h.value),1),e("div",xe,[e("button",{onClick:t[0]||(t[0]=s=>M(-1)),disabled:n.value===1,class:"px-2 py-1 text-sm bg-gray-200 text-gray-700 rounded hover:bg-gray-300 disabled:opacity-50"}," Last Page ",8,_e),e("button",{onClick:t[1]||(t[1]=s=>M(1)),disabled:n.value===h.value,class:"px-2 py-1 text-sm bg-gray-200 text-gray-700 rounded hover:bg-gray-300 disabled:opacity-50"}," Next Page ",8,we)])])):w("",!0)])])]))}},ke={key:0},Ce={key:1,class:"text-center text-gray-500"},Me={key:2,class:"mt-6 flex justify-between items-center"},Ae={class:"text-sm text-gray-500"},Ie={class:"space-x-2"},Se=["disabled"],Pe=["disabled"],Le={key:3,class:"mt-6 text-center"},k=10,Ue={__name:"CommentList",props:{pageId:{type:String,required:!0},currentUserAvatar:{type:String,required:!0},sortBy:{type:String,default:"hot"}},emits:["update-total-comments"],setup(l,{emit:x}){const r=l,a=x,o=y([]),n=y(1),h=y(0),p=y(!1),m=B(()=>Math.ceil(h.value/k)),g=async(t,s)=>{p.value=!0;try{await new Promise($=>setTimeout($,1e3));const u={comments:Array(k).fill().map(($,b)=>({id:`${r.pageId}-${(t-1)*k+b+1}`,username:`用户${(t-1)*k+b+1}`,avatar:"/placeholder.svg?height=40&width=40",content:`这是第${(t-1)*k+b+1}条评论 (页面ID: ${r.pageId}) 😊

# 一级标题

这是正文，支持 **Markdown** 语法。

![示例图片](/placeholder.svg?height=200&width=300)`,likes:Math.floor(Math.random()*100),liked:!1,createdAt:new Date(Date.now()-Math.random()*1e10).toISOString(),replyCount:Math.floor(Math.random()*20)+5,replies:Array(5).fill().map((_,A)=>({id:`${r.pageId}-${(t-1)*k+b+1}-${A+1}`,username:`回复用户${A+1}`,avatar:"/placeholder.svg?height=24&width=24",content:`这是对第${(t-1)*k+b+1}条评论的回复 (页面ID: ${r.pageId}) 👍

支持 *斜体* 和 **粗体**。`,createdAt:new Date(Date.now()-Math.random()*1e9).toISOString()}))})),total:100};o.value=u.comments,h.value=u.total,a("update-total-comments",u.total)}catch(u){console.error("Error fetching comments:",u)}finally{p.value=!1}},f=t=>{const s=n.value+t;s>=1&&s<=m.value&&(n.value=s,g(n.value,r.sortBy))},C=async t=>{const s=o.value.find(u=>u.id===t);s&&(s.liked=!s.liked,s.likes+=s.liked?1:-1)},M=async t=>{const s=o.value.find(u=>u.id===t.commentId);s&&(s.replies.unshift({id:`${r.pageId}-${s.id}-${s.replies.length+1}`,username:"当前用户",avatar:r.currentUserAvatar,content:t.content,createdAt:new Date().toISOString()}),s.replyCount++)},d=async({commentId:t,page:s,perPage:u})=>{const $=o.value.find(b=>b.id===t);$&&($.replies=Array(u).fill().map((b,_)=>({id:`${r.pageId}-${t}-${(s-1)*u+_+1}`,username:`Reply User ${(s-1)*u+_+1}`,avatar:"/placeholder.svg?height=24&width=24",content:`This is reply ${_+1} on page ${s}`,createdAt:new Date(Date.now()-Math.random()*1e9).toISOString()})))};return U(()=>r.sortBy,t=>{n.value=1,g(n.value)}),H(()=>{g(n.value,r.sortBy)}),(t,s)=>(c(),i("div",null,[o.value.length>0?(c(),i("div",ke,[(c(!0),i(S,null,P(o.value,u=>(c(),O($e,{key:u.id,comment:u,"current-user-avatar":l.currentUserAvatar,onLike:C,onReply:M,onLoadReplies:d},null,8,["comment","current-user-avatar"]))),128))])):(c(),i("div",Ce," No comments yet, be the first to comment! ")),h.value>0?(c(),i("div",Me,[e("div",Ae," 第 "+v(n.value)+" 页，共 "+v(m.value)+" 页 ",1),e("div",Ie,[e("button",{onClick:s[0]||(s[0]=u=>f(-1)),disabled:n.value===1,class:"px-4 py-2 bg-gray-200 text-gray-700 rounded-full hover:bg-gray-300 disabled:opacity-50 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-opacity-50"}," Last Page ",8,Se),e("button",{onClick:s[1]||(s[1]=u=>f(1)),disabled:n.value===m.value,class:"px-4 py-2 bg-gray-200 text-gray-700 rounded-full hover:bg-gray-300 disabled:opacity-50 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-opacity-50"}," Next Page ",8,Pe)])])):w("",!0),p.value?(c(),i("div",Le,s[2]||(s[2]=[e("svg",{class:"animate-spin h-5 w-5 mx-auto text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):w("",!0)]))}},Be={class:"mx-auto p-4 rounded-lg"},De={id:"comments",class:"text-xl font-bold mb-4"},Re={class:"mb-4 flex items-center space-x-4 text-sm"},Te=["onClick"],ze={__name:"CommentArea",props:{pageId:{type:String,required:!0}},setup(l){const x=y(0),r=y("hot"),a=[{label:"Hottest",value:"hot"},{label:"Newest",value:"newest"},{label:"Comment Time",value:"time"}],o=y("/placeholder.svg?height=40&width=40"),n=m=>{r.value=m},h=async m=>{x.value++},p=m=>{x.value=m};return(m,g)=>(c(),i("div",Be,[e("h2",De,"Comments ("+v(x.value)+")",1),e("div",Re,[g[0]||(g[0]=e("span",{class:"text-gray-600"},"Sort by",-1)),(c(),i(S,null,P(a,f=>e("button",{key:f.value,onClick:C=>n(f.value),class:D(["px-3 py-1 rounded-full",r.value===f.value?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])},v(f.label),11,Te)),64))]),I(R,{"user-avatar":o.value,onSubmit:h},null,8,["user-avatar"]),I(Ue,{"page-id":l.pageId,"current-user-avatar":o.value,"sort-by":r.value,onUpdateTotalComments:p},null,8,["page-id","current-user-avatar","sort-by"])]))}};export{ze as _};
